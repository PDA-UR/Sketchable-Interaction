<h1 id="pysi-api">PySI API</h1>
<h2 id="introduction">Introduction</h2>
<p>The PySI API facilitates its users to build new SI-Plugins from scratch or extend and modify existing ones. Therefore, the PySI API makes heavy use of object-oriented programming, most notably <strong>Inheritance</strong>. An SI-Plugin is an implementation of an <em>effect</em> of an <em>interactive region</em> (early concept: <a href="#refs">[1]</a>). Such an <em>effect</em> is triggered once end-users overlap two <em>interactive regions</em>, defining a <em>collision</em>. Additionally, <em>interactive regions</em> can be <em>linked</em>. Such <em>linking relationships</em> are defined according to <em>attributes</em>. Application developers specify in the implementation of an <em>effect</em> which <em>attributes</em> of that <em>effect</em> can be linked to which <em>attributes</em> of other <em>effects</em> and which <em>linking action</em> shall occur. Standard <em>attributes</em> are either provided by the PySI API, such as <em>position</em>, or may be created as ad-hoc identifiers which are chosen by application developers. In Sketchable Interaction, everything is considered an SI-plugin. The very canvas you draw on is a plugin, filesystem entries such as files are plugins, where each file type can be done as a plugin which represents that type, etc.</p>
<p>The PySI API aims to streamline the implementation of an SI-Plugin in partially descriptive, partially imperative and self-documenting fashion. This document’s goal is to describe the PySI API beyond its code documentation. Therefore, the next sections describe PySI, its API and use case examples.</p>
<p>If you are just starting out with developing SI-Plugins it may be useful to play around with the PySI API first to get a feel for it. For that, skip ahead to the section <span style="color:blue"><a href="#impl_tag">Example: Implementation of a Tag-Effect</a></span>. The more detailed aspects of PySI and its API are present in the other chapters and may be consulted as required. This document applies the best practices proposed by RFC2119 (keywords <strong>must</strong>, <strong>should</strong>, <strong>may</strong>)<a href="#refs">[2]</a>.</p>
<h2 id="description">Description</h2>
<h3 id="api-integration-in-sigrun">API Integration in SIGRun</h3>
<p>PySI exposes bindings to C++ datastructures and functions. These bindings are built with the use of Boost.Python <a href="#refs">[3]</a> Each plugin file is stored in an <em>object</em> within SIGRun. This <em>object</em> functionally represents the pythonic <em>self</em> in SIGrun. Therefore, the python code implemented in the functions of SI-Plugins is executed by SIGRun once end-users trigger their events and actions. In this way, API users build application logic purely in python (with the use of python libraries available to them), while SIGRun provides the <em>glue</em> to present those applications to end-users.</p>
<h3 id="end-user-interaction">End-User interaction</h3>
<ul>
<li>End-Users <strong>must</strong> first select one of the available effects which are shown in the palette region to the right</li>
<li>End-Users <strong>must</strong> press the left mouse button to perform selection</li>
<li>End-Users <strong>must</strong> press and hold the right mouse button to link the position of the <em>interactive region</em> of the mouse cursor to colliding <em>interactive regions</em></li>
</ul>
<h3 id="the-startup-file">The Startup File</h3>
<h4 id="goal">Goal</h4>
<p>API users configure the startup sequence of SIGRun</p>
<ul>
<li>API users <strong>must</strong> provide a startup file in the <em>plugins</em> folder</li>
<li>API users <strong>may</strong> spawn <em>interactive regions</em></li>
<li>API users <strong>may</strong> configure logging behaviour</li>
</ul>
<h4 id="naming-convention">Naming Convention</h4>
<p>Startup python file <strong>must</strong> be named <em>StartSIGRun.py</em></p>
<h4 id="structure">Structure</h4>
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true"></a><span class="im">from</span> libPySI <span class="im">import</span> PySI</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true"></a><span class="co"># further imports as you see fit such as plugin files for using their static </span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true"></a><span class="co"># members or auxiliary non-plugin python3 files</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true"></a><span class="co"># other variables or functions</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true"></a><span class="kw">def</span> on_start():</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true"></a>    <span class="co"># configuration logic **must** be written here</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true"></a>    <span class="cf">pass</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true"></a><span class="co"># other variables or functions</span></span></code></pre></div>
<p>Summary:</p>
<ul>
<li><em>StartSIGRun.py</em> <strong>must</strong> import libPySI</li>
<li><em>StartSIGRun.py</em> <strong>must</strong> include a module-level function called <em>on_start()</em></li>
<li><em>on_start</em> <strong>must</strong> contain all configuration logic</li>
<li><em>on_start()</em> <strong>must not</strong> have any arguments</li>
<li>API Users <strong>should</strong> create additional functions and variables on module level</li>
</ul>
<h3 id="the-plugin-file">The Plugin File</h3>
<h4 id="goal-1">Goal</h4>
<ul>
<li>API Users implement <em>effects</em> for <em>interactive regions</em></li>
<li>API Users <strong>must</strong> specify collision capabilities (str-value) and callback functions for <em>collision event</em> emissions and receptions
<ul>
<li>on_enter - triggered exactly once when first time collision of <em>interactive regions</em> is detected</li>
<li>on_continuous - triggered in each subsequent SIGRun update when collision remains ongoing</li>
<li>on_leave - triggered exactly once when a previously ongoing collision is detected to have stopped</li>
</ul></li>
<li>API Users <strong>must</strong> specify linking relationships according to attributes (str-values) and linking actions (functions)</li>
<li>API Users <strong>must</strong> place newly built SI-Plugins and associated qml-files within the <em>plugins</em> folder for being usable by SIGRun</li>
</ul>
<h4 id="naming-convention-1">Naming Convention</h4>
<ul>
<li>plugin files <strong>must</strong> contain exactly one class</li>
<li>names of plugin files <strong>must</strong> be the exact same name as the classes they implement</li>
<li>example: Tag.py contains a class called Tag</li>
</ul>
<h4 id="structure-1">Structure</h4>
<p>MyEffect.py</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true"></a><span class="im">from</span> libPySI <span class="im">import</span> PySI</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true"></a><span class="im">from</span> plugins.standard_environment_library.SIEffect <span class="im">import</span> SIEffect</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true"></a><span class="co"># same name as python file </span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true"></a><span class="co"># it is highly recommended to inherit from SIEffect for ease of use</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true"></a><span class="kw">class</span> MyEffect(SIEffect):</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true"></a>    regiontype <span class="op">=</span> PySI.EffectType.SI_CUSTOM</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true"></a>    regionname <span class="op">=</span> PySI.EffectName.SI_STD_NAME_CUSTOM  <span class="co"># name used only internally</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true"></a>    region_display_name <span class="op">=</span> <span class="st">&quot;MyEffect&quot;</span>  <span class="co"># name to be shown to end-users</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, shape<span class="op">=</span>PySI.PointVector(), uuid<span class="op">=</span><span class="st">&quot;&quot;</span>, kwargs<span class="op">=</span>{}):</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true"></a>        <span class="bu">super</span>(MyEffect, <span class="va">self</span>).<span class="fu">__init__</span>(shape, uuid, <span class="st">&quot;res/my_effect.png&quot;</span>,</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true"></a>                                       Button.regiontype, Button.regionname,</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true"></a>                                       kwargs)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true"></a>        </span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true"></a>        <span class="va">self</span>.qml_path <span class="op">=</span> <span class="st">&quot;path/to/MyEffect.qml&quot;</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true"></a>    </span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true"></a>        <span class="co"># further member variables</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true"></a></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true"></a>    <span class="co"># further member functions  </span></span></code></pre></div>
<p>Summary:</p>
<ul>
<li>plugin files <strong>must</strong> import libPySI</li>
<li>plugin files <strong>must</strong> use static member variables <em>regiontye</em>, <em>regionname</em>, and region_display_name</li>
<li><em>regiontye</em> and <em>regionname</em> <strong>must</strong> be intialized according to PySI effect types and effect names respectively (if unsure use above example initialization)</li>
<li><em>init</em>’s signature <strong>must</strong> look exactly as the example above</li>
<li><em>self.qml_path</em> <strong>must</strong> be left empty if no QML file is required to accompany the plugin</li>
<li><em>region_display_name</em> <strong>should not</strong> be an empty str</li>
<li>plugin files <strong>should</strong> import SIEffect for ease of use</li>
<li><em>init</em>’s default parameters <strong>may</strong> be changed</li>
</ul>
<h4 id="enabling-and-disabling-of-effects-and-linking-relationships">Enabling and Disabling of Effects and Linking Relationships</h4>
<div class="sourceCode" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true"></a><span class="im">from</span> libPySI <span class="im">import</span> PySI</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true"></a><span class="im">from</span> plugins.standard_environment_library.SIEffect <span class="im">import</span> SIEffect</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true"></a><span class="kw">class</span> MyEffect(SIEffect):</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true"></a>    regiontype <span class="op">=</span> PySI.EffectType.SI_CUSTOM</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true"></a>    regionname <span class="op">=</span> PySI.EffectName.SI_STD_NAME_CUSTOM</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true"></a>    region_display_name <span class="op">=</span> <span class="st">&quot;MyEffect&quot;</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, shape<span class="op">=</span>PySI.PointVector(), uuid<span class="op">=</span><span class="st">&quot;&quot;</span>, kwargs<span class="op">=</span>{}):</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true"></a>        <span class="bu">super</span>(MyEffect, <span class="va">self</span>).<span class="fu">__init__</span>(shape, uuid, <span class="st">&quot;res/my_effect.png&quot;</span>,</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true"></a>                                       MyEffect.regiontype, MyEffect.regionname,</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true"></a>                                       kwargs)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true"></a>        </span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true"></a>        <span class="va">self</span>.qml_path <span class="op">=</span> <span class="st">&quot;path/to/MyEffect.qml&quot;</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true"></a>    </span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true"></a>        <span class="co"># enable an effect, according to a capability (str-value), to be emitted</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true"></a>        <span class="co"># according to the collision event functions</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true"></a></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true"></a>        <span class="co"># collison_event_on_enter_emit must be a function </span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true"></a>        <span class="co"># (e.g. self.on_collision_event_enter_emit) as parameter </span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true"></a>        <span class="co"># (must not not call the function in the parameter list)</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true"></a></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true"></a>        <span class="co"># collison_event_on_continuous_emit must be a function </span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true"></a>        <span class="co"># (e.g. self.on_collision_event_continuous_emit) as parameter </span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true"></a>        <span class="co"># (must not not call the function in the parameter list)</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true"></a></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true"></a>        <span class="co"># collison_event_on_leave_emit must be a function </span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true"></a>        <span class="co"># (e.g. self.on_collision_event_leave_emit) as parameter </span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true"></a>        <span class="co"># (must not not call the function in the parameter list)</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true"></a>        <span class="va">self</span>.enable_effect(<span class="st">&quot;your_capability&quot;</span>, SIEffect.EMISSION, </span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true"></a>                           <span class="op">&lt;</span>collison_event_on_enter_emit<span class="op">&gt;</span>, </span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true"></a>                           <span class="op">&lt;</span>collison_event_on_continuous_emit<span class="op">&gt;</span>, </span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true"></a>                           <span class="op">&lt;</span>collison_event_on_leave_emit<span class="op">&gt;</span>)</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true"></a>        </span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true"></a>        <span class="co"># enable an effect, according to a capability (str-value), </span></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true"></a>        <span class="co"># to be received according to the collision event functions</span></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true"></a></span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true"></a>        <span class="co"># &quot;your_other_capability&quot; can be any str-value </span></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true"></a>  </span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true"></a>        <span class="co"># collison_event_on_enter_recv must be a function </span></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true"></a>        <span class="co"># (e.g. self.on_collision_event_enter_recv) as parameter </span></span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true"></a>        <span class="co"># (must not not call the function in the parameter list)</span></span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true"></a></span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true"></a>        <span class="co"># collison_event_on_continuous_recv must be a function </span></span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true"></a>        <span class="co"># (e.g. self.on_collision_event_continuous_recv) as parameter </span></span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true"></a>        <span class="co"># (must not not call the function in the parameter list)</span></span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true"></a></span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true"></a>        <span class="co"># collison_event_on_leave_recv must be a function</span></span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true"></a>        <span class="co"># (e.g. self.on_collision_event_leave_recv) as parameter</span></span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true"></a>        <span class="co"># (must not not call the function in the parameter list)</span></span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true"></a>        <span class="va">self</span>.enable_effect(<span class="st">&quot;your_other_capability&quot;</span>, SIEffect.RECEPTION, </span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true"></a>                           <span class="op">&lt;</span>collison_event_on_enter_recv<span class="op">&gt;</span>, </span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true"></a>                           <span class="op">&lt;</span>collison_event_on_continuous_recv<span class="op">&gt;</span>, </span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true"></a>                           <span class="op">&lt;</span>collison_event_on_leave_recv<span class="op">&gt;</span>)</span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true"></a>      </span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true"></a>        <span class="co"># disable an effect, according to a collision capability (str-value), </span></span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true"></a>        <span class="co"># so the effect stops being emitted</span></span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true"></a></span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true"></a>        <span class="co"># &quot;your_capability&quot; can be any str-value </span></span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true"></a>        <span class="va">self</span>.disable_effect(<span class="st">&quot;your_capability&quot;</span>, SIEffect.EMISSION)</span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true"></a></span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true"></a>        <span class="co"># disable an effect, according to a collision capability (str-value),</span></span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true"></a>        <span class="co"># so the effect stops being received</span></span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true"></a></span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true"></a>        <span class="co"># &quot;your_other_capability&quot; can be any str-value  </span></span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true"></a>        <span class="va">self</span>.disable_effect(<span class="st">&quot;your_other_capability&quot;</span>, SIEffect.RECEPTION)</span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true"></a>        </span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true"></a>        <span class="co"># enable a link, according to an attribute (str-value), so that the </span></span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true"></a>        <span class="co"># effect emits the given linking action (function)</span></span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true"></a></span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true"></a>        <span class="co"># &quot;your_attribute&quot; may be any str-value</span></span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true"></a></span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true"></a>        <span class="co"># &lt;linking_action_for_emission&gt; must be a function </span></span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true"></a>        <span class="co"># (e.g. self.linking_action) as parameter</span></span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true"></a>        <span class="co"># (must not not call the function in the parameter list)</span></span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true"></a>        <span class="va">self</span>.enable_link_emission(<span class="st">&quot;your_attribute&quot;</span>, </span>
<span id="cb3-77"><a href="#cb3-77" aria-hidden="true"></a>                                  <span class="op">&lt;</span>linking_action_for_emission<span class="op">&gt;</span>)</span>
<span id="cb3-78"><a href="#cb3-78" aria-hidden="true"></a>        </span>
<span id="cb3-79"><a href="#cb3-79" aria-hidden="true"></a>        <span class="co"># enable a link, according to a source attribute (str-value) and target </span></span>
<span id="cb3-80"><a href="#cb3-80" aria-hidden="true"></a>        <span class="co"># attribute, so that the effect receives a linking action according to </span></span>
<span id="cb3-81"><a href="#cb3-81" aria-hidden="true"></a>        <span class="co"># the given function</span></span>
<span id="cb3-82"><a href="#cb3-82" aria-hidden="true"></a></span>
<span id="cb3-83"><a href="#cb3-83" aria-hidden="true"></a>        <span class="co"># &quot;your_attribute&quot; can be any str-value</span></span>
<span id="cb3-84"><a href="#cb3-84" aria-hidden="true"></a>        <span class="co"># &lt;linking_action_for_emission&gt; must be a function </span></span>
<span id="cb3-85"><a href="#cb3-85" aria-hidden="true"></a>        <span class="co"># (e.g. self.linking_action) as parameter </span></span>
<span id="cb3-86"><a href="#cb3-86" aria-hidden="true"></a>        <span class="co"># (must not not call the function in the parameter list)</span></span>
<span id="cb3-87"><a href="#cb3-87" aria-hidden="true"></a>        <span class="va">self</span>.enable_link_reception(<span class="st">&quot;source_attribute&quot;</span>, <span class="st">&quot;your_attribute&quot;</span>, </span>
<span id="cb3-88"><a href="#cb3-88" aria-hidden="true"></a>                                   <span class="op">&lt;</span>linking_action_for_reception<span class="op">&gt;</span>)</span>
<span id="cb3-89"><a href="#cb3-89" aria-hidden="true"></a>        </span>
<span id="cb3-90"><a href="#cb3-90" aria-hidden="true"></a>        <span class="co"># disable a link, according to an attribute (str-value), so that the </span></span>
<span id="cb3-91"><a href="#cb3-91" aria-hidden="true"></a>        <span class="co"># effect stops emitting that linking action  </span></span>
<span id="cb3-92"><a href="#cb3-92" aria-hidden="true"></a>        <span class="va">self</span>.disable_link_emission(<span class="st">&quot;your_attribute&quot;</span>)</span>
<span id="cb3-93"><a href="#cb3-93" aria-hidden="true"></a>    </span>
<span id="cb3-94"><a href="#cb3-94" aria-hidden="true"></a>        <span class="co">#disable a link, according to a source_attribute and target attribute, </span></span>
<span id="cb3-95"><a href="#cb3-95" aria-hidden="true"></a>        <span class="co"># so that the effect stops receiving that linking action</span></span>
<span id="cb3-96"><a href="#cb3-96" aria-hidden="true"></a>        <span class="co"># specify &quot;your_attribute&quot; to selectively disable that exact linking </span></span>
<span id="cb3-97"><a href="#cb3-97" aria-hidden="true"></a>        <span class="co"># relationship</span></span>
<span id="cb3-98"><a href="#cb3-98" aria-hidden="true"></a>        <span class="co"># leave &quot;your_attribute&quot; empty (&quot;&quot;) to disable all linking relationships</span></span>
<span id="cb3-99"><a href="#cb3-99" aria-hidden="true"></a>        <span class="co"># which are triggered by &quot;source_attribute&quot;</span></span>
<span id="cb3-100"><a href="#cb3-100" aria-hidden="true"></a>        <span class="va">self</span>.disable_link_reception(<span class="st">&quot;source_attribute&quot;</span>, <span class="st">&quot;your_attribute&quot;</span>) </span></code></pre></div>
<p>Summary:</p>
<ul>
<li>API users <strong>must</strong> specify own names for capabilities and attributes if those are not part of PySI API</li>
<li>Emitting <em>collision event</em> functions <strong>must</strong> have one additional argument which is the receiving effect (e.g. def collison_event_on_enter_emit(self, other))</li>
<li>API users <strong>should</strong> use the functions enable_effect, disable_effect, enable_link_emission, disable_link_emission, enable_link_reception, disable_link_reception to register required <em>collision events</em> and <em>linking actions</em></li>
<li>API users <strong>should</strong> use PySI built-in capabilities and attributes if available e.g. PySI.CollisionCapability.DELETION (for collision with deletion region) or PySI.LinkingCapability.POSITION (for linking to position attribute)</li>
</ul>
<h3 id="the-qml-file">The QML File</h3>
<h4 id="goal-2">Goal</h4>
<ul>
<li>API Users <strong>must</strong> use qml-files to define which styling an <em>effect</em> applies to its associated <em>interactive regions</em> beyond flat coloring</li>
<li>API Users <strong>must</strong> place qml-files next to their associated SI-Plugins within the <em>plugins</em> folder for being usable by SIGRun</li>
<li>QML-files and plugin-files <strong>should</strong> come in pairs</li>
<li>Plugin-files *+may** have no associated qml-file</li>
<li>QML<a href="#refs">[4]</a> facilitates styling and modifying the style of regions at runtime for API Users</li>
</ul>
<h4 id="naming-convention-2">Naming Convention</h4>
<ul>
<li>QML-files <strong>must</strong> have exactly the same name as their associated plugin-files except for their file endings</li>
<li>example: MyEffect.py and MyEffect.qml</li>
</ul>
<h4 id="structure-2">Structure</h4>
<div class="sourceCode" id="cb4"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true"></a>Item</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true"></a>{</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true"></a>    <span class="kw">function</span> updateData(data)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true"></a>    {</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true"></a>        <span class="co">// apply data</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true"></a>        <span class="co">// e.g. </span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true"></a>        <span class="co">// image.width = data.width;</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true"></a>    }</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true"></a>    <span class="dt">id</span><span class="op">:</span> container</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true"></a>    <span class="dt">visible</span><span class="op">:</span> <span class="kw">true</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true"></a>    </span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true"></a>    <span class="co">// further QML components such as Item, Image, etc.</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true"></a>    <span class="co">// .</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true"></a>    <span class="co">// .</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true"></a>    <span class="co">// .</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true"></a>}</span></code></pre></div>
<p>Summary:</p>
<ul>
<li>API Users <strong>must</strong> view the axis-aligned bounding box of a shape or contour of an <em>interactive region</em> as a container for QML components</li>
<li>API Users <strong>must</strong> conform to QML-Syntax</li>
<li>API Users <strong>must</strong> provide a function <em>updateData(data)</em> which takes exactly one argument</li>
<li>API Users <strong>must</strong> use the <em>updateData(data)</em>-function to update qml-file and styling at runtime</li>
<li>API Users <strong>should</strong> define one <em>Item</em> in the qml-file which contains all other qml-components</li>
<li>API Users <strong>may</strong> change the parameter <em>data</em> to another identifier of their choosing</li>
</ul>
<h4 id="data-application">Data Application</h4>
<p>Data originates from python calls in a SI-Plugin</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true"></a><span class="va">self</span>.set_QML_data(<span class="st">&quot;width&quot;</span>, <span class="dv">200</span>, PySI.DataType.INT)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true"></a><span class="va">self</span>.set_QML_data(<span class="st">&quot;height&quot;</span>, <span class="dv">300</span>, PySI.DataType.INT)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true"></a><span class="va">self</span>.set_QML_data(<span class="st">&quot;visible&quot;</span>, <span class="va">True</span>, PySI.DataType.BOOL)</span></code></pre></div>
<p>and then data is applied in QML for registering the styling changes</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true"></a>Item</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true"></a>{</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true"></a>    <span class="kw">function</span> updateData(data)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true"></a>    {</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true"></a>        <span class="co">// update the width, height and visibility of the container with data </span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true"></a>        <span class="co">//    received from the associated plugin-file</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true"></a>        <span class="co">// the key/value pairs of data-parameter are equal to the ones specified</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true"></a>        <span class="co">//    in set_QML_data</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true"></a>        container<span class="op">.</span><span class="at">width</span> <span class="op">=</span> data<span class="op">.</span><span class="at">width</span><span class="op">;</span>  <span class="co">// container.width now has the value 200</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true"></a>        container<span class="op">.</span><span class="at">height</span> <span class="op">=</span> data<span class="op">.</span><span class="at">height</span><span class="op">;</span>  <span class="co">// container.height now has the value </span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true"></a>        <span class="co">//    300</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true"></a>        container<span class="op">.</span><span class="at">visible</span> <span class="op">=</span> data<span class="op">.</span><span class="at">visible</span><span class="op">;</span>  <span class="co">// container.visible now has the </span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true"></a>        <span class="co">//    value true</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true"></a>    }</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true"></a></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true"></a>    <span class="dt">id</span><span class="op">:</span> container</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true"></a>    <span class="dt">visible</span><span class="op">:</span> <span class="kw">false</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true"></a>    </span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true"></a>    <span class="co">// further QML components such as Item, Image, etc.</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true"></a>    <span class="co">// .</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true"></a>    <span class="co">// .</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true"></a>    <span class="co">// .</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true"></a>}</span></code></pre></div>
<p>Summary:</p>
<ul>
<li><em>data</em>-parameter is of type JavaScript-Object</li>
<li>API Users <strong>must</strong> use the <em>updateData(data)</em>-function to update qml-file and styling at runtime</li>
<li>API Users <strong>must</strong> use common JavaScript for the <em>updateData(data)</em>-function</li>
<li>API USers <strong>must</strong> call the function <em>self.set_QML_data(key, value, datatype)</em> from within the python plugin to change data in the qml-file
<ul>
<li><em>key</em>-parameter directly translates to the key identifier in the JavaScript object <em>data</em> (example: self.set_QML_data(“width”, 100, PySI.DataType.INT) will result in data.width = 100)</li>
<li><em>value</em>-parameter depicts the value assigned to the perviously specified key of the <em>data</em>-object</li>
<li><em>datatype</em>-parameter is required by SIGRun to transfer the data changes to QML</li>
</ul></li>
<li>API Users <strong>must</strong> assign values of the <em>data</em>-object to qml-components pre-defined in the qml-file</li>
<li>API Users <strong>may</strong> use this procedure to update any qml-component which is supported by QML such as Image, Item, etc.</li>
</ul>
<h3 id="use-of-non-plugin-python-files">Use Of Non-Plugin Python Files</h3>
<h4 id="goal-3">Goal</h4>
<p>API Users <strong>may</strong> perform <em>code decomposition</em> by defining python files and classes which SIGRun <strong>must not</strong> treat as SI-Plugins</p>
<h4 id="naming-convention-3">Naming Convention</h4>
<ul>
<li>Classes in Non-Plugin Python Files <strong>must</strong> be named with two leading underscores (e.g. class __MyClass)</li>
<li>Non-Plugin Python Files <strong>may</strong> contain classes</li>
<li>API Users <strong>may</strong> name Non-Plugin Python Files as they chose</li>
</ul>
<h4 id="structure-3">Structure</h4>
<p>Non-Plugin Python File</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true"></a></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true"></a><span class="co"># module level functions</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true"></a><span class="co"># SIGRun scans for classes and ignores module level functions per default</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true"></a><span class="kw">def</span> do_job():</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true"></a>    <span class="cf">pass</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true"></a><span class="co"># static class for helper functions (e.g. for better definition of namespaces)</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true"></a><span class="co"># __ as name prefix prevents SIGRun to read it as a SI-Plugin</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true"></a><span class="kw">class</span> __MyHelperFunctions:</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true"></a>    <span class="at">@staticmethod</span> </span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true"></a>    <span class="kw">def</span> do_work():</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true"></a>        <span class="cf">pass</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true"></a></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true"></a>    <span class="co">#function</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true"></a>    <span class="co"># .</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true"></a>    <span class="co"># .</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true"></a>    <span class="co"># .</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true"></a></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true"></a><span class="co"># class defining behaviour or serving as a complex datastructure for use in </span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true"></a><span class="co"># plugins</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true"></a></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true"></a><span class="co"># __ as name prefix prevents SIGRun to read it as a SI-Plugin</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true"></a><span class="kw">class</span> __MyHelperDatastructure:</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, args, kwargs):</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true"></a>        <span class="co"># assignment </span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true"></a>        <span class="cf">pass</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true"></a>    </span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true"></a>    <span class="co"># functions</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true"></a>    <span class="co"># .</span></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true"></a>    <span class="co"># .</span></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true"></a>    <span class="co"># .</span></span></code></pre></div>
<p>Summary:</p>
<ul>
<li>Non-Plugin Python Files <strong>must not</strong> contain classes which names do not start with two leading underscores</li>
<li>API Users <strong>should</strong> use Non-Plugin Python files for decomposition purposes</li>
<li>Non-Plugin Python Files <strong>may</strong> have module level functions</li>
<li>Non-Plugin Python Files <strong>may</strong> have classes</li>
</ul>
<h3 id="pysi-internal-bindings-to-c-datastructures">PySI Internal Bindings to C++-Datastructures</h3>
<p>The following sections describes the special datastructures of PySI which <strong>must</strong> be used in SI-Plugins. These datastructures originate from SIGRun and are exposed via C++-bindings which are generated with Boost.Python. The PySI API streamlines their usage.</p>
<h4 id="point2">Point2</h4>
<div class="sourceCode" id="cb8"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true"></a>    p <span class="op">=</span> PySI.Point2(<span class="dv">5</span>, <span class="dv">5</span>)</span></code></pre></div>
<p>Summary:</p>
<ul>
<li>custom datastructure to represent 2D points</li>
<li>API users <strong>must</strong> provide two float values (x, y) to the constructor</li>
<li>Point2 is a custom <em>initialization only</em> exposure of the datatype <em>glm::vec2</em> <a href="#refs">[5]</a></li>
<li>API Users <strong>may not</strong> require to use this datastructure directly</li>
</ul>
<h4 id="point3">Point3</h4>
<div class="sourceCode" id="cb9"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true"></a>    p <span class="op">=</span> PySI.Point3(<span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">1</span>)</span></code></pre></div>
<p>Summary:</p>
<ul>
<li>custom datastructure to represent 3D points</li>
<li>API users <strong>must</strong> provide three float values (x, y, z) to the constructor</li>
<li>API users <strong>should</strong> should initialize the <em>z</em>-value to <em>1</em></li>
<li>Point3 is a custom <em>initialization only</em> exposure of the datatype <em>glm::vec3</em> <a href="#refs">[5]</a></li>
<li>API Users <strong>may not</strong> require to use this datastructure directly</li>
</ul>
<h4 id="color">Color</h4>
<div class="sourceCode" id="cb10"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true"></a>    color <span class="op">=</span> PySI.Color(<span class="dv">255</span>, <span class="dv">0</span>, <span class="dv">255</span>, <span class="dv">255</span>)</span></code></pre></div>
<p>Summary:</p>
<ul>
<li>custom datastructure to represent RGBA colors</li>
<li>API users <strong>must</strong> provide four float values (r, g, b, a) to the constructor</li>
<li>Color is a custom <em>initialization only</em> exposure of the datatype <em>glm::vec4</em> <a href="#refs">[5]</a></li>
</ul>
<h4 id="linkrelation">LinkRelation</h4>
<div class="sourceCode" id="cb11"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true"></a>    lr <span class="op">=</span> PySI.LinkRelation(source_uuid, source_attrib, target_uuid, target_attrib)</span></code></pre></div>
<p>Summary:</p>
<ul>
<li>custom datastructure to represent linking relationships</li>
<li>API Users <strong>must</strong> provide four str values (source_effect_uuid, source_effect_attribute, target_effect_uuid, target_effect_attribute) to the constructor</li>
<li>API Users <strong>may not</strong> require to use this datastructure directly</li>
</ul>
<h4 id="pointvector">PointVector</h4>
<div class="sourceCode" id="cb12"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true"></a>    <span class="co"># construction</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true"></a>    pts <span class="op">=</span> PySI.PointVector()  <span class="co"># empty</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true"></a>    pts <span class="op">=</span> PySI.PointVector([[<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>], ..., [m, n, <span class="dv">1</span>]]) <span class="co"># list of points</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true"></a>    <span class="co"># appending</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true"></a>    pts.append(PySI.Point3(x, y, z)) <span class="co"># appending Point3 directly</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true"></a>    pts.append([x, y, z]) <span class="co"># appending Point3 python list of exactly three floats</span></span></code></pre></div>
<p>Summary:</p>
<ul>
<li>custom datastructure to represent a list of Point3 datastructures</li>
<li>PointVector is usable in a pythonic way equally to python lists</li>
<li>API Users <strong>must</strong> provide a list of lists of three floats to the constructor or leave it empty</li>
<li>API Users <strong>must</strong> provide three floats inside the inner list when using python lists for initialization or appending</li>
<li>API Users <strong>may not</strong> require to use this datastructure directly</li>
</ul>
<h4 id="linkrelationvector">LinkRelationVector</h4>
<div class="sourceCode" id="cb13"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true"></a>    <span class="co"># construction with list of link relationships</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true"></a>    lrv <span class="op">=</span> PySI.LinkRelationVector()  <span class="co"># empty</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true"></a>    lrv <span class="op">=</span> PySI.PointVector([[source_uuid, source_attribute, target_uuid, </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true"></a>                             target_attribute], ...]) </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true"></a>    <span class="co"># appending LinkRelation directly</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true"></a>    pts.append(PySI.LinkRelation(source_uuid, source_attrib, target_uuid,</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true"></a>                                 target_attrib))  </span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true"></a>    </span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true"></a>    <span class="co"># appending LinkRelation indirectly with python list of exactly four strings</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true"></a>    pts.append([source_uuid, source_attrib, target_uuid, target_attrib])  </span></code></pre></div>
<p>Summary:</p>
<ul>
<li>custom datastructure to represent a list of link relationships</li>
<li>LinkRelationVector is usable in a pythonic way equally to python lists</li>
<li>API Users <strong>must</strong> provide a list of lists of four str values to the constructor or leave it empty</li>
<li>API Users <strong>must</strong> provide four str-values inside the inner list when using python lists for initialization or appending</li>
<li>API Users <strong>may not</strong> require to use this datastructure directly</li>
</ul>
<h4 id="stringvector">StringVector</h4>
<div class="sourceCode" id="cb14"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true"></a>    <span class="co"># construction</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true"></a>    sv <span class="op">=</span> PySI.StringVector()  <span class="co"># empty</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true"></a>    sv <span class="op">=</span> PySI.StringVector([<span class="st">&quot;str&quot;</span>, <span class="st">&quot;str2&quot;</span>, ..., <span class="st">&quot;strn&quot;</span>])  <span class="co"># list of link relationships</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true"></a>    <span class="co"># appending</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true"></a>    sv.append(<span class="st">&quot;str&quot;</span>)  <span class="co"># appending str value directly</span></span></code></pre></div>
<p>Summary:</p>
<ul>
<li>custom datastructure to represent a list of strings</li>
<li>StringVector is usable in a pythonic way equally to python lists</li>
<li>StringVector is a custom exposure of <strong>std::vector<std::string></strong></li>
<li>API Users <strong>must</strong> provide a list of str values to the constructor or leave it empty</li>
<li>API Users <strong>must</strong> provide a str-value when appending to a StringVector</li>
<li>API Users <strong>may not</strong> require to use this datastructure directly</li>
</ul>
<h4 id="partialcontour">PartialContour</h4>
<div class="sourceCode" id="cb15"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true"></a>    <span class="co"># construction is not performed manually</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true"></a>    <span class="co"># appending of new cursor id</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true"></a>    <span class="co"># adding PointVector value directly</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true"></a>    <span class="va">self</span>.__partial_regions__[cursor_uuid] <span class="op">=</span> PySI.PointVector()  </span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true"></a>    <span class="co"># appending of point according to cursor id</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true"></a>    <span class="co"># adding PointVector value directly</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true"></a>    <span class="co"># adding PointVector value directly</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true"></a>    <span class="va">self</span>.__partial_regions__[cursor_uuid].append(PySI.Point3(x, y, <span class="dv">1</span>))  </span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true"></a>    <span class="va">self</span>.__partial_regions__[cursor_uuid].append([x, y, <span class="dv">1</span>])  </span></code></pre></div>
<ul>
<li>Custom datastructure to represent a contour/shape which is currently drawn by an end-user</li>
<li>PartialContour is usable in a pythonic way equally to python dicts</li>
<li>PartialContour is custom exposure of a <strong>std::map&lt;std::string, std::vector<glm::vec3>&gt;</strong> datastructure</li>
<li>PartialContour uses uuids of cursor plugins as key (str value) for values of type PointVector</li>
<li>API users <strong>must</strong> provide string/PointVector key/value pair to add data</li>
<li>API users <strong>must</strong> provide a valid uuid of a valid cursor as key</li>
<li>API Users <strong>must not</strong> call the constructor directly as this is handled by PySI</li>
<li>API Users <strong>should not</strong> require to use this datastructure directly as it is only required when building a <em>canvas</em> plugin</li>
<li>API Users <strong>should not</strong> build a new <em>canvas</em> plugin</li>
</ul>
<h4 id="string2functionmap">String2FunctionMap</h4>
<div class="sourceCode" id="cb16"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true"></a>    <span class="co"># e.g. linking relationships eligible for emission are stored in a </span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true"></a>    <span class="co"># String2FunctionMap per SI-plugin</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true"></a>    </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true"></a>    <span class="kw">def</span> link_emission():</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true"></a>        <span class="cf">return</span> <span class="st">&quot;emit&quot;</span>    </span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true"></a>    </span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true"></a>    <span class="co"># construction</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true"></a>    link_emit <span class="op">=</span> PySI.String2FunctionMap()</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true"></a>    link_emit <span class="op">=</span> PySI.String2FunctionMap({<span class="st">&quot;my_link_attribute_to_emit&quot;</span>, link_emission})</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true"></a>    </span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true"></a>    <span class="co"># assignment</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true"></a>    link_emit[<span class="st">&quot;my_link_attribute_to_emit&quot;</span>] <span class="op">=</span> link_emission</span></code></pre></div>
<ul>
<li>Custom datastructure to represent key/value pairs of str-values and python functions</li>
<li>String2FunctionMap is usable in a pythonic way equally to python dicts</li>
<li>API Users <strong>must</strong> provide a python dict with str-value keys and functions as values to the constructor or leave it empty</li>
<li>API Users <strong>may not</strong> require to use this datastructure directly</li>
</ul>
<h4 id="string2string2functionmapmap">String2String2FunctionMapMap</h4>
<p>In linking action source effect:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true"></a>    <span class="co"># emission functions used in example below</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true"></a>    <span class="kw">def</span> emit_data(<span class="va">self</span>):</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true"></a>        <span class="cf">return</span> x, y, z, <span class="va">self</span>._uuid</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true"></a>    <span class="va">self</span>.enable_link_emission(<span class="st">&quot;my_source_attribute&quot;</span>, <span class="va">self</span>.emit_data)</span></code></pre></div>
<p>In linking action target effect</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true"></a>    <span class="co"># e.g. linking relationships eligible for reception are stored in a </span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true"></a>    <span class="co"># String2String2FunctionMapMap per SI-plugin</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true"></a>    <span class="va">self</span>.enable_link_reception(<span class="st">&quot;my_source_attribute&quot;</span>, <span class="st">&quot;my_target &quot;</span>, <span class="va">self</span>.receive_data)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true"></a>    <span class="co"># number of args is dependant on the number of returned values (tuple) of </span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true"></a>    <span class="co"># the emission function</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true"></a>    <span class="kw">def</span> receive_data(<span class="va">self</span>, x, y, z, source_uuid):</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true"></a>        <span class="co"># use data of linking action    </span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true"></a>        <span class="cf">pass</span>    </span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true"></a>    </span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true"></a>    <span class="co"># construction</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true"></a>    link_recv <span class="op">=</span> PySI.String2String2FunctionMapMap()</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true"></a>    </span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true"></a>    link <span class="op">=</span> {<span class="st">&quot;my_source_link_attribute&quot;</span>: {<span class="st">&quot;my_target_link_attribute&quot;</span>: <span class="va">self</span>.receive_data}</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true"></a>    link_recv <span class="op">=</span> PySI.String2String2FunctionMapMap(link)</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true"></a>    </span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true"></a>    <span class="co"># assignment</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true"></a>    link_recv[<span class="st">&quot;my_source_link_attribute&quot;</span>][<span class="st">&quot;my_target_link_attribute&quot;</span>] <span class="op">=</span> <span class="va">self</span>.receive_data</span></code></pre></div>
<ul>
<li>Custom datastructure to represent key/value pairs of str-values and String2FunctionMap</li>
<li>String2String2FunctionMapMap is usable in a pythonic way equally to python dicts containing values of dicts</li>
<li>API Users <strong>must</strong> provide a python dict with str-value keys and dicts as values, which represent String2FunctionMap, to the constructor or leave it empty</li>
<li>API Users <strong>may not</strong> require to use this datastructure directly</li>
</ul>
<h2 id="impl_tag">Example: Implementation of a Tag-Effect</h2>
<h3 id="goal-4">Goal:</h3>
<ul>
<li>Implement an effect to visually tag a colliding region with a blue square</li>
</ul>
<h3 id="building-tag.py">Building Tag.py</h3>
<div class="sourceCode" id="cb19"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true"></a>    </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true"></a><span class="im">from</span> libPySI <span class="im">import</span> PySI</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true"></a><span class="im">from</span> plugins.standard_environment_library.SIEffect <span class="im">import</span> SIEffect</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true"></a><span class="kw">class</span> Tag(SIEffect):</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true"></a>    regiontype <span class="op">=</span> PySI.EffectType.SI_CUSTOM</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true"></a>    regionname <span class="op">=</span> PySI.EffectName.SI_STD_NAME_TAG</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true"></a>    region_display_name <span class="op">=</span> <span class="st">&quot;Tag&quot;</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true"></a></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, shape<span class="op">=</span>PySI.PointVector(), uuid<span class="op">=</span><span class="st">&quot;&quot;</span>, kwargs<span class="op">=</span>{}):</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true"></a>        <span class="bu">super</span>(Tag, <span class="va">self</span>).<span class="fu">__init__</span>(shape, uuid, <span class="st">&quot;res/tag.png&quot;</span>, Tag.regiontype, </span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true"></a>                                  Tag.regionname, kwargs)</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true"></a>        <span class="co"># specify which qml file to use</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true"></a>        <span class="va">self</span>.qml_path <span class="op">=</span> <span class="st">&quot;plugins/standard_environment_library/tag/Tag.qml&quot;</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true"></a>            </span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true"></a>        <span class="co"># specify which color a region having the tag-effect should have</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true"></a>        <span class="va">self</span>.color <span class="op">=</span> PySI.Color(<span class="dv">255</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">255</span>)</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true"></a></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true"></a>        <span class="co"># add and enable the tagging effect by specifying its capability and </span></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true"></a>        <span class="co"># and assigning its collision event functions</span></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true"></a>        <span class="va">self</span>.enable_effect(<span class="st">&quot;tagging&quot;</span>, SIEffect.EMISSION, <span class="va">self</span>.on_tag_enter_emit,</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true"></a>                           <span class="va">self</span>.on_tag_continuous_emit, <span class="va">self</span>.on_tag_leave_emit)</span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true"></a></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true"></a>    <span class="co"># define the functions needed for collision events with the &quot;tagging&quot; capability</span></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true"></a>    </span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true"></a>    <span class="co"># when another eligible effect first collides with this one, emit that the </span></span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true"></a>    <span class="co"># other one should be tagged</span></span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true"></a>    <span class="kw">def</span> on_tag_enter_emit(<span class="va">self</span>, other):</span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true"></a>        <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true"></a>    </span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true"></a>    <span class="co"># it makes no sense to redundantly tag the other effect on every collision </span></span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true"></a>    <span class="co"># event, so we leave this blank </span></span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true"></a>    <span class="kw">def</span> on_tag_continuous_emit(<span class="va">self</span>, other):</span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true"></a>        <span class="cf">pass</span></span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true"></a>    </span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true"></a>    <span class="co"># we want to keep the tag beyond collision, so we leave this also blank</span></span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true"></a>    <span class="kw">def</span> on_tag_leave_emit(<span class="va">self</span>, other):</span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true"></a>        <span class="cf">pass</span> </span></code></pre></div>
<p>Using the Tag-effect within a region yields something like this when drawn in SIGRun: <img src="res/tag_without_tex.png" style="width:40.0%" /></p>
<p>Even though we specified a texture path (res/tag.png) in the constructor and specified a qml-file path (plugins/standard_environment_library/tag/Tag.qml), we do not see the texture on top of our region. In order to to make this styling visible we have to build the qml-file which associated with the Tag-effect.</p>
<h3 id="building-tag.qml">Building Tag.qml</h3>
<div class="sourceCode" id="cb20"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true"></a><span class="im">import</span> QtQuick <span class="fl">2.7</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true"></a>Item</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true"></a>{</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true"></a>    <span class="co">// apply data provided by the SI-plugin</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true"></a>    <span class="kw">function</span> updateData(data)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true"></a>    {</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true"></a>        image<span class="op">.</span><span class="at">width</span> <span class="op">=</span> data<span class="op">.</span><span class="at">img_width</span><span class="op">;</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true"></a>        image<span class="op">.</span><span class="at">height</span> <span class="op">=</span> data<span class="op">.</span><span class="at">img_height</span><span class="op">;</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true"></a>        image<span class="op">.</span><span class="at">source</span> <span class="op">=</span> data<span class="op">.</span><span class="at">img_path</span><span class="op">;</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true"></a></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true"></a>        image<span class="op">.</span><span class="at">anchors</span><span class="op">.</span><span class="at">leftMargin</span> <span class="op">=</span> data<span class="op">.</span><span class="at">widget_width</span> <span class="op">/</span> <span class="dv">2</span> <span class="op">-</span> image<span class="op">.</span><span class="at">width</span> <span class="op">/</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true"></a>        image<span class="op">.</span><span class="at">anchors</span><span class="op">.</span><span class="at">topMargin</span> <span class="op">=</span> data<span class="op">.</span><span class="at">widget_height</span> <span class="op">/</span> <span class="dv">2</span> <span class="op">-</span> image<span class="op">.</span><span class="at">height</span> <span class="op">/</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true"></a>    }</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true"></a></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true"></a>    <span class="dt">id</span><span class="op">:</span> container</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true"></a>    <span class="dt">visible</span><span class="op">:</span> <span class="kw">true</span></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true"></a></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true"></a>    Image {</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true"></a>        <span class="dt">id</span><span class="op">:</span> image</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true"></a>        anchors<span class="op">.</span><span class="at">left</span><span class="op">:</span> parent<span class="op">.</span><span class="at">left</span></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true"></a>        anchors<span class="op">.</span><span class="at">top</span><span class="op">:</span> parent<span class="op">.</span><span class="at">top</span></span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true"></a></span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true"></a>        <span class="dt">visible</span><span class="op">:</span> <span class="kw">true</span></span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true"></a>    }</span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true"></a>}</span></code></pre></div>
<p>Above example is the default qml-file for each SI-Plugin. It provides the functionality to draw a texture on top of a region and center it in the region. This file can automatically be created if the SIQML file template is used. PySI SIEffect automatically manages texture application once a texture path is provided in the constructor of an effect. This may look like this (in SIEffect constructor):</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true"></a><span class="va">self</span>.texture_path <span class="op">=</span> texture_path</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true"></a><span class="cf">if</span> <span class="va">self</span>.texture_path <span class="op">!=</span> <span class="st">&quot;&quot;</span>:</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true"></a>    <span class="co">## member attribute variable storing the width of a texture of a region </span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true"></a>    <span class="co"># drawing as a float</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true"></a>    <span class="co">#</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true"></a>    <span class="co"># This value is only set if texture_path is a valid path</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true"></a>    <span class="va">self</span>.texture_width <span class="op">=</span> <span class="dv">75</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true"></a></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true"></a>    <span class="co">## member attribute variable storing the height of a texture of a region </span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true"></a>    <span class="co"># drawing as a float</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true"></a>    <span class="co">#</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true"></a>    <span class="co"># This value is only set if texture_path is a valid path</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true"></a>    <span class="va">self</span>.texture_height <span class="op">=</span> <span class="dv">75</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true"></a>    </span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true"></a>    <span class="co"># apply data in QML </span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true"></a>    <span class="va">self</span>.__set_data__(<span class="st">&quot;img_width&quot;</span>, <span class="va">self</span>.texture_width, PySI.DataType.INT)</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true"></a>    <span class="va">self</span>.__set_data__(<span class="st">&quot;img_height&quot;</span>, <span class="va">self</span>.texture_height, PySI.DataType.INT)</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true"></a>    <span class="va">self</span>.__set_data__(<span class="st">&quot;img_path&quot;</span>, <span class="va">self</span>.texture_path, PySI.DataType.STRING)</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true"></a>    <span class="va">self</span>.__set_data__(<span class="st">&quot;widget_width&quot;</span>, <span class="va">self</span>.width, PySI.DataType.FLOAT)</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true"></a>    <span class="va">self</span>.__set_data__(<span class="st">&quot;widget_height&quot;</span>, <span class="va">self</span>.height, PySI.DataType.FLOAT)</span></code></pre></div>
<p>Now that we have created a qml-file for our SI-Plugin, we finally can see the region texture on top of our region: <img src="res/tag_with_tex.png" style="width:40.0%" alt="region with tag effect with texture" /></p>
<p>Now that we can fully draw our newly created Tag-effect in SIGRun, we want to see it in action. In order to do so, we have to adjust or create effects which can receive Tag-effects.</p>
<h3 id="adjusting-a-receiver-effect">Adjusting a receiver effect</h3>
<p>For this example, we expand the TextFile-plugin from the SI standard environment library. First, we have to enable the Tag-effect in TextFile.py.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true"></a>    <span class="co"># in the constructor</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true"></a>    <span class="co"># note that the &quot;tagging&quot; capability has to be received here</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true"></a>    <span class="co"># we only implemented on_enter in Tag.py so here we only need on_enter as well</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true"></a>    <span class="va">self</span>.enable_effect(<span class="st">&quot;tagging&quot;</span>, <span class="va">self</span>.RECEPTION, <span class="va">self</span>.on_tag_enter_recv, <span class="va">None</span>, <span class="va">None</span>)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true"></a>    <span class="co"># outside of the constructor but inside the class, we have to define </span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true"></a>    <span class="co"># on_tag_enter_recv</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true"></a>    <span class="co"># note that we have the is_tagged parameter due to returning one value </span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true"></a>    <span class="co"># in the emission function in Tag.py    </span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true"></a>    <span class="co"># modify qml in order to show the tag on a region having the TextFile-effect</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true"></a>    <span class="kw">def</span> on_tag_enter_recv(<span class="va">self</span>, is_tagged):</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true"></a>        <span class="va">self</span>.set_QML_data(<span class="st">&quot;visible&quot;</span>, is_tagged, PySI.DataType.BOOL)         </span></code></pre></div>
<p>Additionally, we have to adjust TextFile.qml as well to support this new functionality. In updateData(data)-function we add the line:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true"></a>    <span class="kw">function</span> <span class="fu">updateData</span>(data)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true"></a>    {</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true"></a>        <span class="co">// .</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true"></a>        <span class="co">// .</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true"></a>        <span class="co">// .</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true"></a>        </span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true"></a>       tag<span class="op">.</span><span class="at">visible</span> <span class="op">=</span> data<span class="op">.</span><span class="at">visible</span><span class="op">;</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true"></a>    }</span></code></pre></div>
<p>And within the container component (<em>Item</em>), we add a <em>Rectangle</em> component:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true"></a>    Item</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true"></a>    {</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true"></a>        <span class="kw">function</span> updateData(data)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true"></a>        {</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true"></a>            <span class="co">// .</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true"></a>            <span class="co">// .</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true"></a>            <span class="co">// .</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true"></a>    </span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true"></a>            tag<span class="op">.</span><span class="at">visible</span> <span class="op">=</span> data<span class="op">.</span><span class="at">visible</span><span class="op">;</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true"></a>        }</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true"></a>    </span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true"></a>        <span class="dt">id</span><span class="op">:</span> container</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true"></a>    </span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true"></a>        <span class="dt">visible</span><span class="op">:</span> <span class="kw">true</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true"></a></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true"></a>        <span class="co">// .</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true"></a>        <span class="co">// .</span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true"></a>        <span class="co">// .</span></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true"></a>    </span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true"></a>        Rectangle {</span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true"></a>           <span class="dt">id</span><span class="op">:</span> tag</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true"></a>           <span class="dt">width</span><span class="op">:</span> <span class="dv">15</span></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true"></a>           <span class="dt">height</span><span class="op">:</span> <span class="dv">15</span></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true"></a>           <span class="dt">color</span><span class="op">:</span> <span class="st">&quot;blue&quot;</span></span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true"></a>           <span class="dt">visible</span><span class="op">:</span> <span class="kw">false</span></span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true"></a>        }</span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true"></a>    }</span></code></pre></div>
<p>And finally after that, we can visually tag our TextFiles:</p>
<p><img src="res/pre_tag.png" style="width:30.0%" /> <img src="res/tag.png" style="width:30.0%" /> <img src="res/post_tag.png" style="width:30.0%" /></p>
<p>However, this is a minimal example for visually tagging a TextFile. Of course, you can expand this approach by passing meta data, use different colors and shapes, according to your preferences and requirements.</p>
<h2 id="a-more-complex-use-case-example-plot.py-and-plot.qml">A More Complex Use Case Example: Plot.py and Plot.qml</h2>
<p>Preface:</p>
<p>The Tag-Effect is fairly simple and may hide the possibilities of SI, or at least makes it more difficult to grasp what is actually possible. To see the more powerful side of SI, you should have a look at the following sections. In that sections, an SI-Plugin is implemented which displays the result of a <strong>matplotlib</strong> plot within an <em>interactive region</em>.</p>
<p>Prerequesites:</p>
<ul>
<li>SIGRun <em>must</em> represent <em>interactive regions</em> as Qt5 QWidgets which <em>should</em> have exactly one QML QQuickWidget as a child object</li>
<li>SIGRun <em>must</em> apply the size of the axis-aligned bounding box (AABB) of a region drawing to that region’s Qwidget’s size to be displayed correctly</li>
<li>SIGRun <em>may</em> display regions in unexpected ways if data such as images exceed the regions’ AABB’s or qml container component’s dimensions</li>
</ul>
<p>Application:</p>
<ul>
<li>API Users <em>must</em> define a new and big enough shape or contour of an effect’s associated <em>interactive region</em> for data such as images to be properly displayed by SIRen if the region’s original AABB’s are exceeded</li>
<li>API Users <em>must</em> define new and big enough dimensions of the container component in the associated qml file for data such as images to be properly displayed by SIRen if the region’s original qml container component’s dimenions are exceeded</li>
</ul>
<div class="sourceCode" id="cb25"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true"></a><span class="im">from</span> libPySI <span class="im">import</span> PySI</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true"></a><span class="im">from</span> plugins.standard_environment_library.SIEffect <span class="im">import</span> SIEffect</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true"></a><span class="im">import</span> matplotlib</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true"></a>matplotlib.use(<span class="st">&#39;Agg&#39;</span>)  <span class="co"># required</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true"></a></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true"></a><span class="kw">class</span> Plot(SIEffect):</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true"></a>    regiontype <span class="op">=</span> PySI.EffectType.SI_CUSTOM</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true"></a>    regionname <span class="op">=</span> <span class="st">&quot;__PLOT__&quot;</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true"></a>    region_display_name <span class="op">=</span> <span class="st">&quot;Plot&quot;</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true"></a></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, shape<span class="op">=</span>PySI.PointVector(), uuid<span class="op">=</span><span class="st">&quot;&quot;</span>, kwargs<span class="op">=</span>{}):</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true"></a>        <span class="bu">super</span>(Plot, <span class="va">self</span>).<span class="fu">__init__</span>(shape, uuid, <span class="st">&quot;res/dot-plot.png&quot;</span>, </span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true"></a>                                   Plot.regiontype, Plot.regionname, kwargs)</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true"></a>        <span class="va">self</span>.qml_path <span class="op">=</span> <span class="st">&quot;plugins/standard_environment_library/plot/Plot.qml&quot;</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true"></a>        <span class="va">self</span>.color <span class="op">=</span> PySI.Color(<span class="dv">63</span>, <span class="dv">136</span>, <span class="dv">143</span>, <span class="dv">255</span>)</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true"></a>    </span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true"></a>        <span class="co"># matplotlib code required to plot a graph</span></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true"></a>        figure <span class="op">=</span> plt.figure()</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true"></a>        plot <span class="op">=</span> figure.add_subplot(<span class="dv">111</span>)</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true"></a></span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true"></a>        x <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">100</span>, <span class="fl">0.1</span>)</span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true"></a>        y <span class="op">=</span> np.sin(x) <span class="op">/</span> x</span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true"></a>        plot.plot(x, y)</span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true"></a>    </span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true"></a>        <span class="co"># retrieve the plot as numpy.ndarray</span></span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true"></a>        np_fig <span class="op">=</span> <span class="va">self</span>.fig_2_ndarray(figure)</span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true"></a></span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true"></a>        <span class="co"># get image dimensions</span></span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true"></a>        <span class="va">self</span>.width, <span class="va">self</span>.height, _ <span class="op">=</span> np_fig.shape</span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true"></a>    </span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true"></a>        <span class="co"># get effect&#39;s associated region&#39;s current x and y coordinates </span></span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true"></a>        <span class="co"># (top left corner of region&#39;s axis-aligned bounding box)</span></span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true"></a>        <span class="co"># for relative_x_pos() and relative_y_pos() see code documentation of PySI</span></span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true"></a>        x <span class="op">=</span> <span class="va">self</span>.relative_x_pos()</span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true"></a>        y <span class="op">=</span> <span class="va">self</span>.relative_y_pos()</span>
<span id="cb25-38"><a href="#cb25-38" aria-hidden="true"></a>    </span>
<span id="cb25-39"><a href="#cb25-39" aria-hidden="true"></a>        <span class="co"># current shape may be too small to contain the complete image</span></span>
<span id="cb25-40"><a href="#cb25-40" aria-hidden="true"></a>        <span class="co"># recompute shape according to image size at the regions position</span></span>
<span id="cb25-41"><a href="#cb25-41" aria-hidden="true"></a>        <span class="co"># now image exactly fits into the shape (and therefore Qt5 QWidget) </span></span>
<span id="cb25-42"><a href="#cb25-42" aria-hidden="true"></a>        <span class="va">self</span>.shape <span class="op">=</span> PySI.PointVector([[x, y], [x, y <span class="op">+</span> <span class="va">self</span>.height], </span>
<span id="cb25-43"><a href="#cb25-43" aria-hidden="true"></a>                                      [x <span class="op">+</span> <span class="va">self</span>.width, y <span class="op">+</span> <span class="va">self</span>.height], </span>
<span id="cb25-44"><a href="#cb25-44" aria-hidden="true"></a>                                      [x <span class="op">+</span> <span class="va">self</span>.width, y]])</span>
<span id="cb25-45"><a href="#cb25-45" aria-hidden="true"></a>        </span>
<span id="cb25-46"><a href="#cb25-46" aria-hidden="true"></a>        <span class="co"># assign new data to QML for styling</span></span>
<span id="cb25-47"><a href="#cb25-47" aria-hidden="true"></a>        <span class="va">self</span>.set_QML_data(<span class="st">&quot;image&quot;</span>, np_fig.tobytes(), PySI.DataType.BYTES, </span>
<span id="cb25-48"><a href="#cb25-48" aria-hidden="true"></a>                          {<span class="st">&quot;width&quot;</span>: <span class="va">self</span>.width, <span class="st">&quot;height&quot;</span>: <span class="va">self</span>.height})</span>
<span id="cb25-49"><a href="#cb25-49" aria-hidden="true"></a></span>
<span id="cb25-50"><a href="#cb25-50" aria-hidden="true"></a>        <span class="va">self</span>.set_QML_data(<span class="st">&quot;img_width&quot;</span>, <span class="va">self</span>.width, PySI.DataType.INT)</span>
<span id="cb25-51"><a href="#cb25-51" aria-hidden="true"></a>        <span class="va">self</span>.set_QML_data(<span class="st">&quot;img_height&quot;</span>, <span class="va">self</span>.height, PySI.DataType.INT)</span>
<span id="cb25-52"><a href="#cb25-52" aria-hidden="true"></a></span>
<span id="cb25-53"><a href="#cb25-53" aria-hidden="true"></a>        <span class="co"># adjust the container component&#39;s dimensions to fith the target image</span></span>
<span id="cb25-54"><a href="#cb25-54" aria-hidden="true"></a>        <span class="co"># adjust the container component&#39;s width to target image&#39;s width</span></span>
<span id="cb25-55"><a href="#cb25-55" aria-hidden="true"></a>        <span class="va">self</span>.set_QML_data(<span class="st">&quot;widget_width&quot;</span>, <span class="va">self</span>.width, PySI.DataType.FLOAT)</span>
<span id="cb25-56"><a href="#cb25-56" aria-hidden="true"></a>        <span class="co"># adjust the container component&#39;s height to target image&#39;s height</span></span>
<span id="cb25-57"><a href="#cb25-57" aria-hidden="true"></a>        <span class="va">self</span>.set_QML_data(<span class="st">&quot;widget_height&quot;</span>, <span class="va">self</span>.height, PySI.DataType.FLOAT)</span>
<span id="cb25-58"><a href="#cb25-58" aria-hidden="true"></a></span>
<span id="cb25-59"><a href="#cb25-59" aria-hidden="true"></a>    <span class="co"># helper function for getting a plot as numpy.ndarray</span></span>
<span id="cb25-60"><a href="#cb25-60" aria-hidden="true"></a>    <span class="kw">def</span> fig_2_ndarray(<span class="va">self</span>, fig, mode<span class="op">=</span><span class="st">&quot;rgba&quot;</span>):</span>
<span id="cb25-61"><a href="#cb25-61" aria-hidden="true"></a>        fig.canvas.draw()</span>
<span id="cb25-62"><a href="#cb25-62" aria-hidden="true"></a></span>
<span id="cb25-63"><a href="#cb25-63" aria-hidden="true"></a>        w, h <span class="op">=</span> fig.canvas.get_width_height()</span>
<span id="cb25-64"><a href="#cb25-64" aria-hidden="true"></a>        buf <span class="op">=</span> np.fromstring(fig.canvas.tostring_argb(), dtype<span class="op">=</span>np.uint8)</span>
<span id="cb25-65"><a href="#cb25-65" aria-hidden="true"></a>        buf.shape <span class="op">=</span> (w, h, <span class="dv">4</span>)</span>
<span id="cb25-66"><a href="#cb25-66" aria-hidden="true"></a></span>
<span id="cb25-67"><a href="#cb25-67" aria-hidden="true"></a>        <span class="cf">if</span> mode <span class="op">==</span> <span class="st">&quot;rgba&quot;</span>:</span>
<span id="cb25-68"><a href="#cb25-68" aria-hidden="true"></a>            <span class="co"># convert to rgba</span></span>
<span id="cb25-69"><a href="#cb25-69" aria-hidden="true"></a>            buf <span class="op">=</span> np.roll(buf, <span class="dv">3</span>, axis<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb25-70"><a href="#cb25-70" aria-hidden="true"></a>            <span class="cf">return</span> buf</span>
<span id="cb25-71"><a href="#cb25-71" aria-hidden="true"></a>        <span class="cf">elif</span> mode <span class="op">==</span> <span class="st">&quot;argb&quot;</span>:</span>
<span id="cb25-72"><a href="#cb25-72" aria-hidden="true"></a>            <span class="cf">return</span> buf</span></code></pre></div>
<p>QML-file:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true"></a><span class="im">import</span> QtQuick <span class="fl">2.7</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true"></a><span class="im">import</span> siqml <span class="fl">1.0</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true"></a>Item {</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true"></a>    <span class="kw">function</span> updateData(data) {</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true"></a>        <span class="cf">if</span>(data<span class="op">.</span><span class="at">image</span>)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true"></a>        {</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true"></a>            plot_texture<span class="op">.</span><span class="at">image</span> <span class="op">=</span> data<span class="op">.</span><span class="at">image</span><span class="op">;</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true"></a>            plot_texture<span class="op">.</span><span class="at">width</span> <span class="op">=</span> data<span class="op">.</span><span class="at">img_width</span><span class="op">;</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true"></a>            plot_texture<span class="op">.</span><span class="at">height</span> <span class="op">=</span> data<span class="op">.</span><span class="at">img_height</span><span class="op">;</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true"></a></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true"></a>            plot_texture<span class="op">.</span><span class="at">anchors</span><span class="op">.</span><span class="at">leftMargin</span> <span class="op">=</span> data<span class="op">.</span><span class="at">widget_width</span> <span class="op">/</span> <span class="dv">2</span> <span class="op">-</span> plot_texture<span class="op">.</span><span class="at">width</span> <span class="op">/</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true"></a>            plot_texture<span class="op">.</span><span class="at">anchors</span><span class="op">.</span><span class="at">topMargin</span> <span class="op">=</span> data<span class="op">.</span><span class="at">widget_height</span> <span class="op">/</span> <span class="dv">2</span> <span class="op">-</span> plot_texture<span class="op">.</span><span class="at">height</span> <span class="op">/</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true"></a>        }</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true"></a></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true"></a>        idle_texture<span class="op">.</span><span class="at">width</span> <span class="op">=</span> data<span class="op">.</span><span class="at">icon_width</span><span class="op">;</span></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true"></a>        idle_texture<span class="op">.</span><span class="at">height</span> <span class="op">=</span> data<span class="op">.</span><span class="at">icon_height</span><span class="op">;</span></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true"></a>        idle_texture<span class="op">.</span><span class="at">source</span> <span class="op">=</span> data<span class="op">.</span><span class="at">img_path</span><span class="op">;</span></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true"></a></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true"></a>        idle_texture<span class="op">.</span><span class="at">anchors</span><span class="op">.</span><span class="at">leftMargin</span> <span class="op">=</span> data<span class="op">.</span><span class="at">widget_width</span> <span class="op">/</span> <span class="dv">2</span> <span class="op">-</span> idle_texture<span class="op">.</span><span class="at">width</span> <span class="op">/</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true"></a>        idle_texture<span class="op">.</span><span class="at">anchors</span><span class="op">.</span><span class="at">topMargin</span> <span class="op">=</span> data<span class="op">.</span><span class="at">widget_height</span> <span class="op">/</span> <span class="dv">2</span> <span class="op">-</span> idle_texture<span class="op">.</span><span class="at">height</span> <span class="op">/</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true"></a>    }</span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true"></a></span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true"></a>    <span class="dt">id</span><span class="op">:</span> container</span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true"></a>        <span class="dt">visible</span><span class="op">:</span> <span class="kw">true</span></span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true"></a></span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true"></a>    Image {</span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true"></a>        <span class="dt">id</span><span class="op">:</span> idle_texture</span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true"></a></span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true"></a>        anchors<span class="op">.</span><span class="at">left</span><span class="op">:</span> parent<span class="op">.</span><span class="at">left</span></span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true"></a>        anchors<span class="op">.</span><span class="at">top</span><span class="op">:</span> parent<span class="op">.</span><span class="at">top</span></span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true"></a>    }</span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true"></a></span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true"></a>    PlotItem {</span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true"></a>        <span class="dt">id</span><span class="op">:</span> plot_texture</span>
<span id="cb26-36"><a href="#cb26-36" aria-hidden="true"></a>    }</span>
<span id="cb26-37"><a href="#cb26-37" aria-hidden="true"></a>}</span></code></pre></div>
<p>Without adjusting the shape and qml container component of the target <em>interactive region</em>, behaviour such as this can be expected:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true"></a>    <span class="co"># shape and container will not be adjusted</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true"></a>    <span class="co"># self.shape = PySI.PointVector([[x, y], [x, y + self.height], </span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true"></a>    <span class="co">#                               [x + self.width, y + self.height], [x + self.width, y]])</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true"></a>    <span class="co">#</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true"></a>    <span class="co"># self.set_QML_data(&quot;widget_width&quot;, self.width, PySI.DataType.FLOAT)</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true"></a>    <span class="co"># self.set_QML_data(&quot;widget_height&quot;, self.height, PySI.DataType.FLOAT)</span></span></code></pre></div>
<p><img src="res/no_shape_adjustment_sketch.png" title="Drawing an *interactive region* intended to contain a plot" style="width:40.0%" alt="img" /> <img src="res/no_shape_adjustment_plot.png" title="Plot is rendered within the *interactive region*, however the image is cut-off due to no adjustment of the region&#39;s shape" style="width:40.0%" alt="img" /></p>
<p>However, adjusting the shape of the target region yields the desired output:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true"></a>    <span class="co"># shape will be adjusted</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true"></a>    <span class="va">self</span>.shape <span class="op">=</span> PySI.PointVector([[x, y], [x, y <span class="op">+</span> <span class="va">self</span>.height], </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true"></a>                                  [x <span class="op">+</span> <span class="va">self</span>.width, y <span class="op">+</span> <span class="va">self</span>.height], [x <span class="op">+</span> <span class="va">self</span>.width, y]])</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true"></a>    <span class="va">self</span>.set_QML_data(<span class="st">&quot;widget_width&quot;</span>, <span class="va">self</span>.width, PySI.DataType.FLOAT)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true"></a>    <span class="va">self</span>.set_QML_data(<span class="st">&quot;widget_height&quot;</span>, <span class="va">self</span>.height, PySI.DataType.FLOAT)</span></code></pre></div>
<p><img src="res/shape_adjustment_sketch.png" title="Drawing an *interactive region* intended to contain a plot" style="width:40.0%" alt="img" /> <img src="res/shape_adjustment_plot.png" title="Plot is rendered within the *interactive region* and the image is not cut-off due to the adjustment of the region&#39;s shape" style="width:40.0%" alt="img" /></p>
<p>Summary:</p>
<ul>
<li>API Users <em>must</em> use self.shape in conjunction with the assignment of a new PySI.PointVector which is initialized with a python list (see example above) to reassign the shape of the effect’s associated shape or contour</li>
<li>API Users <em>should</em> compute a new and big enough shape to fit an image which exceeds the region’s AABB’s current dimensions as the AABB <strong>must</strong> be viewed as the QML container</li>
<li>API Users <em>may</em> encounter unexpected behaviour in terms of rendering a region when its styling data and size do not match</li>
</ul>
<h2 id="refs">References</h2>
<p>[1] Wimmer, R., &amp; Hahn, J. (2018). A Concept for Sketchable Workspaces and Workflows. <a>https://epub.uni-regensburg.de/36818/1/A%20Concept%20for%20Sketchable%20Workspaces%20and%20Workflows.pdf</a></p>
<p>[2] RFC2119. https://tools.ietf.org/html/rfc2119</p>
<p>[3] Boost.Python. https://www.boost.org/doc/libs/1_73_0/libs/python/doc/html/index.html</p>
<p>[4] QML. https://doc.qt.io/qt-5/qtqml-index.html</p>
<p>[5] GLM. https://glm.g-truc.net/0.9.9/index.html</p>
